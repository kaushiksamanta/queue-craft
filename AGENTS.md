# Repository Guidelines

## Project Structure
- `src/`: library source (`publisher.ts`, `worker.ts`, `connection.ts`).
- `src/types/`, `src/utils/`: shared typings/helpers.
- `tests/unit/`, `tests/integration/`: Vitest suites (`*.test.ts`).
- `examples/`: runnable publisher/worker samples.
- `docs/`: architecture/usage docs.
- `dist/`: generated by `npm run build` (do not edit).

## Architecture Overview
- QueueCraft wraps RabbitMQ into `Publisher` (produce) and `Worker` (consume) with typed events.
- Default exchange is topic; handler keys become bindings; `queueName` becomes the queue.
- Retries use delay queues with backoff; failures route to DLQ.
- Shared connection manager handles reconnection and health checks.

## Commands
- `npm install`: install deps.
- `npm run build`: compile to `dist/`.
- `npm test` / `npm run test:unit`: unit tests.
- `npm run test:integration`: integration tests (RabbitMQ).
- `npm run test:with-rabbitmq`: spin up RabbitMQ and run full suite.
- `npm run test:coverage`: unit coverage.
- `npm run lint` / `npm run lint:fix`: ESLint.
- `npm run format`: Prettier.
- `npm run example:publisher` / `npm run example:worker`: run examples.

## Style & Design
- TypeScript strict; Prettier (2-space, semicolons); ESLint with `@typescript-eslint`.
- Keep modules small and cohesive; export via `src/index.ts`.
- Favor composition; centralize broker concerns in `connection.ts`, `publisher.ts`, `worker.ts`.

## Testing Patterns
- Unit tests mock `amqplib`; integration tests use real RabbitMQ.
- One behavior per `it` block; `describe` per module.

## Environment & Config
- Node.js 18+ recommended.
- RabbitMQ defaults from `docker-compose.yml` (`guest`/`guest`, `5672`, UI `15672`).

## Commits & PRs
- Short, imperative messages; use prefixes like `feat:`/`refactor:` when relevant.
- PRs: description, tests run, docs/examples updated if behavior or API changes.
